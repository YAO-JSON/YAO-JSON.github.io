webpackJsonp([10],{173:function(e,t,i){e.exports=i.p+"e825205360d70e108d3bf994a30d56fb.jpg"},255:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(1).default.component("oriItem",{template:'<li>\n\t\t<div class="clear">\n\t\t\t<div class="lt cursor">\n\t\t\t\t<span  v-show="!model.isExpend" v-if="model.type < 3" @click="getLocalData(model)" >\n\t\t\t\t\t<Icon type="plus-circled" size="16"  color="#39f" ></Icon>\n\t\t\t\t</span>\n\t\t\t\t<span  v-show="model.isExpend" v-if="model.type < 3" @click="getLocalData(model)" >\n\t\t\t\t\t<Icon type="minus-circled" size="16"  color="#39f" ></Icon>\n\t\t\t\t</span>\n\t\t\t\t<span style="margin-left:5px" @click="selCity(model)">\n\t\t\t\t\t{{model.name}}\n\t\t\t\t</span>\n\t\t\t\t<span v-show="model.isHandler" class="cursor">\n\t\t\t\t\t<Icon type="checkmark-round" color="#f20" ></Icon>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<ul v-show="model.isExpend">\n\t\t\t<ori-item class=\'line line-office\' :model="model" v-for="model in model.areaChildren" :key="model"></ori-item>\n\t\t</ul>\n\t</li>',data:function(){return{open:!1}},props:{model:Object},methods:{getLocalData:function(e){if(e.areaChildren&&!e.areaChildren.length){var t="/home/location/location/original_region";t+="?id="+e.id+"&name="+e.name,this.fetch(t).then(function(t){if(t.data.code&&t.data.data)for(var i=t.data.data,r=0;r<i.length;r++)e.type<3&&(i[r].type<3&&(i[r].areaChildren=[]),i[r].status=1==i[r].status,i[r].isExpend=!1,i[r].isHandler=!!e.isHandler,e.areaChildren.push(i[r]))})}e.isExpend=!e.isExpend},selCity:function(e){e.isHandler=!e.isHandler,e.areaChildren&&e.areaChildren.length&&function e(t,i,r){for(var n=0;n<i.length;n++)i[n].isHandler=t,i[n].type<3&&i[n].areaChildren&&i[n].areaChildren.length&&e(t,i[n].areaChildren,i[n])}(e.isHandler,e.areaChildren)}}}),t.default={data:function(){return{title:"新建运费模板",self:this,formItem:{name:"",type:"",id:"",others_price:"0.00",frist_one:0,frist_price:"0.00",others_one:0},formItemRule:{name:{required:!0,message:"请输入模板名称！",trigger:"blur"},type:{required:!0,message:"请选择计费方式",trigger:"click"}},datagrid:{head:[],head0:[{title:"可配送区域",key:"address"},{title:"首件（个）",key:"frist_one",render:function(e){return'<i-input v-model="formItem.frist_one" :value="formItem.frist_one"></i-input>'}},{title:"运费（元）",key:"frist_price",render:function(e){return'<i-input v-model="formItem.frist_price" :value="formItem.frist_price"></i-input>'}},{title:"续件（个）",key:"others_one",render:function(e){return'<i-input v-model="formItem.others_one" :value="formItem.others_one"></i-input>'}},{title:"续费（元）",key:"others_price",render:function(e){return'<i-input v-model="formItem.others_price" :value="formItem.others_price"></i-input>'}}],head1:[{title:"可配送区域",key:"address"},{title:"首重（kg）",key:"frist_one",render:function(e){return'<i-input v-model="formItem.frist_one" :value="formItem.frist_one"></i-input>'}},{title:"运费（元）",key:"frist_price",render:function(e){return'<i-input v-model="formItem.frist_price" :value="formItem.frist_price"></i-input>'}},{title:"续重（kg）",key:"others_one",render:function(e){return'<i-input v-model="formItem.others_one" :value="formItem.others_one" ></i-input>'}},{title:"续费（元）",key:"others_price",render:function(e){return'<i-input v-model="formItem.others_price" :value="formItem.others_price"></i-input>'}}],data:[]},model:{isOpen:!1,title:""},region:[],selAddress:null,isEdit:!1,Bool:{isShowYunfeiPicture:!1}}},created:function(){this.$bus.emit("updateMainMenuTitle","插件管理"),this.$bus.emit("updateMainMenuActive","5-0"),this.getRegion(),this.datagrid.head=this.datagrid.head0,this.$route.query.id&&(this.formItem.id=this.$route.query.id,this.title=this.$route.query.title,this.getModel(this.formItem.id))},watch:{region:{deep:!0,handler:function(e,t){function i(e,t){for(var r=0;r<t.length;r++)t[r].areaChildren&&t[r].areaChildren.length&&i(t[r],t[r].areaChildren);e.isHandler=t.some(function(e){return e.isHandler})}for(var r=0;r<e.length;r++)e[r].areaChildren&&e[r].areaChildren.length&&i(e[r],e[r].areaChildren)}}},methods:{getModel:function(e){var t=this,i="/home/fee/fee_add?id="+e;this.fetch(i).then(function(e){var i=e.data.data;if(1==e.data.code){t.isEdit=!0,t.formItem.name=i.fee_name,t.formItem.frist_one=i.frist_one,t.formItem.frist_price=i.frist_price,t.formItem.id=i.id,t.formItem.others_price=i.others_price,t.formItem.others_one=i.others,t.formItem.type=i.type;var r=i.tree;1==i.type?t.datagrid.head=t.datagrid.head1:t.datagrid.head=t.datagrid.head0,t.selAddress=r;var n=[];!function(e,t){for(var i=0;i<t.length;i++)if(t[i].child&&t[i].child.length)for(var r=0;r<t[i].child.length;r++){var n=t[i].child[r].name;if(t[i].child[r].child&&t[i].child[r].child.length){for(var o=[],a=0;a<t[i].child[r].child.length;a++)o.push(t[i].child[r].child[a].name);n+=" ：("+o.join("，")+")"}e.push(n)}else e.push(t[i].name)}(n,r),t.datagrid.data=[{address:n.join("；"),frist_one:t.formItem.frist_one,frist_price:t.formItem.frist_price,others_one:t.formItem.others_one,others_price:t.formItem.others_price}]}})},getRegion:function(){var e=this;this.region=[],this.fetch("/home/location/location/add").then(function(t){if(1==t.data.code&&t.data.data)for(var i=t.data.data.region,r=0;r<i.length;r++)i[r].type<3&&(i[r].areaChildren=[],i[r].status=1==i[r].status,i[r].isExpend=!1,i[r].isHandler=!1,e.region.push(i[r]))})},save:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var i={};i.type=t.formItem.type,""===i.type&&t.$Message.error("请选择计费方式"),i.fee_name=t.formItem.name,t.formItem.id&&(i.id=t.formItem.id),i.frist_one=t.formItem.frist_one,i.frist_price=t.formItem.frist_price,i.others=t.formItem.others_one,i.others_price=t.formItem.others_price,i.address=t.selAddress,i.address||t.$Message.error("请选择可配送区域！"),t.fetch("/home/fee/fee_add",i).then(function(e){1==e.data.code&&t.$router.push("/home/addons/freight-set")})}else t.$Message.error("表单验证失败")})},back:function(){this.$router.go(-1)},changeFee:function(e){this.datagrid.head=this.datagrid["head"+e]},addFeeModel:function(){this.model.isOpen=!0,this.model.title="选择配送区域"},changeRow:function(e){this.datagrid.data=[e]},ok:function(){function e(t,i){for(var r=0;r<i.length;r++)if(i[r].isHandler){var n={name:i[r].name,type:i[r].type,region_id:i[r].id};i[r].areaChildren?(0==i[r].areaChildren.length?n.ful=1:(n.child=[],n.ful=0,e(n.child,i[r].areaChildren)),t.push(n)):t.push(n)}}var t=this.region,i=[];e(i,t),this.selAddress=i;for(var r=[],n=0;n<i.length;n++)if(i[n].child&&i[n].child.length)for(var o=0;o<i[n].child.length;o++){var a=i[n].child[o].name;if(i[n].child[o].child&&i[n].child[o].child.length){for(var s=[],l=0;l<i[n].child[o].child.length;l++)s.push(i[n].child[o].child[l].name);a+=" ：("+s.join("，")+") "}r.push(a)}else r.push(i[n].name);var d={address:r.join("；"),frist_one:0,frist_price:"0.00",others_price:"0.00",others_one:0};this.datagrid.data=[d]},cancal:function(){},showYunfei:function(){this.Bool.isShowYunfeiPicture=!0}}}},557:function(e,t){},58:function(e,t,i){i(557);var r=i(6)(i(255),i(583),null,null);r.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/pages/home/addons/freight-add.vue",r.esModule&&Object.keys(r.esModule).some(function(e){return"default"!==e&&"__esModule"!==e}),r.options.functional,e.exports=r.exports},583:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Modal",{attrs:{title:e.model.title},on:{"on-ok":e.ok,"on-cancal":e.cancal},model:{value:e.model.isOpen,callback:function(t){e.model.isOpen=t},expression:"model.isOpen"}},[r("div",[r("Row",[r("Col",{staticStyle:{color:"#fff"},attrs:{span:"2"}},[e._v("\n\t\t\t\t\t\tnia\n\t\t\t\t\t")]),e._v(" "),r("Col",{attrs:{span:"20"}},[r("Row",[r("Col",{staticStyle:{border:"1px solid #ddd"},attrs:{span:"24"}},[r("div",{staticClass:"selProce"},[e._v("\n\t\t\t\t\t\t\t\t\t可选省、市、区\n\t\t\t\t\t\t\t\t")]),e._v(" "),r("ul",{staticClass:"ul-500"},e._l(e.region,function(e){return r("ori-item",{key:e,staticClass:"line line-office cursor",attrs:{model:e}})}))])],1)],1),e._v(" "),r("Col",{staticStyle:{color:"#fff"},attrs:{span:"2"}},[e._v("\n\t\t\t\t\t\tni\n\t\t\t\t\t")])],1)],1)]),e._v(" "),r("Breadcrumb",{staticStyle:{background:"#f8f8f8",padding:"10px 28px","margin-bottom":"15px"}},[r("Breadcrumb-item",{attrs:{href:"/home/addons/freight-set"}},[e._v("插件管理")]),e._v(" "),r("Breadcrumb-item",[r("span",[e._v("\t"+e._s(e.title))])])],1),e._v(" "),r("Form",{ref:"formRef",attrs:{"label-width":100,model:e.formItem,rules:e.formItemRule}},[r("Form-item",{staticClass:"label-width",attrs:{label:"模板名称：",prop:"name"}},[r("Input",{model:{value:e.formItem.name,callback:function(t){e.formItem.name=t},expression:"formItem.name"}})],1),e._v(" "),r("Form-item",{staticClass:"label-width",attrs:{label:"计费方式："}},[r("Radio-group",{on:{"on-change":e.changeFee},model:{value:e.formItem.type,callback:function(t){e.formItem.type=t},expression:"formItem.type"}},[r("Radio",{attrs:{label:"0"}},[e._v("按件数")]),e._v(" "),r("Radio",{attrs:{label:"1"}},[e._v("按重量")])],1)],1),e._v(" "),r("Form-item",{attrs:{label:"配送区域："}},[r("Table",{attrs:{context:e.self,columns:e.datagrid.head,data:e.datagrid.data}})],1),e._v(" "),r("Form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}]},[r("Button",{attrs:{type:"ghost"},on:{click:e.addFeeModel}},[e._v("添加配送区域")])],1),e._v(" "),r("Form-item",{staticClass:"label-width",attrs:{label:""}},[r("Button",{attrs:{type:"primary"},on:{click:function(t){e.save("formRef")}}},[e._v("保存")]),e._v(" "),r("Button",{on:{click:e.back}},[e._v("返回")])],1),e._v(" "),r("Form-item",[r("Button",{staticStyle:{color:"#39f"},attrs:{type:"text"},on:{click:e.showYunfei}},[e._v("运费计算规则")])],1)],1),e._v(" "),r("Modal",{attrs:{title:"运费计算规则"},model:{value:e.Bool.isShowYunfeiPicture,callback:function(t){e.Bool.isShowYunfeiPicture=t},expression:"Bool.isShowYunfeiPicture"}},[r("div",{staticClass:"imgSelf"},[r("img",{attrs:{src:i(173)}})])])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});