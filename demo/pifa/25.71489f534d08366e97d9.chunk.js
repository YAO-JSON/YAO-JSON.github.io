webpackJsonp([25],{259:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{single:!1,setActivity:!1,add:[],is_fee:0,isadd:!1,addActivity:!1,activityId:""}},created:function(){this.getActivity(),this.$bus.emit("updateMainMenuTitle","插件管理"),this.$bus.emit("updateMainMenuActive","5-0")},watch:{add:function(e,t){e.length>3&&(e=e.slice(0,3))}},methods:{getActivity:function(){var e=this;this.fetch("/home/delivery/delivery/index").then(function(t){if(1==t.data.code&&t.data.data){var i=t.data.data,d=i.delivery;e.add=[];var a=[];i.id&&(e.activityId=i.id);for(var s=0;s<d.length;s++){var r={order_price:d[s].order_price,discount_price:d[s].discount_price,is_fee:Boolean(d[s].is_fee)};d[s].id&&(r.id=d[s].id),a.push(r)}e.add=a}})},setRebate:function(){this.add.push({order_price:0,discount_price:0,is_fee:!1,status:1})},addset:function(){2==this.add.length&&(this.isadd=!0),this.add.push({order_price:0,discount_price:0,is_fee:!1,status:1})},del:function(e,t){var i=this;t?this.fetch("/home/delivery/delivery/del_row?status=0&id="+t).then(function(e){e&&e.data.data&&i.getActivity()}):this.add.splice(e,1)},isFee:function(e,t){e.is_fee&&1!=this.add.length&&this.add.forEach(function(e,i){t!==i&&(e.is_fee=!1)})},saveRebate:function(){for(var e=this,t=[],i=0;i<this.add.length;i++){if(this.add[i].order_price<=0)return void this.$Notice.open({title:"请填写订单金额"});if(this.add[i].discount_price<=0)return void this.$Notice.open({title:"请填写减免金额"});if(this.add[i].discount_price-0>=this.add[i].order_price-0)return void this.$Notice.open({title:"订单金额应大于减免金额"});var d={discount_price:this.add[i].discount_price,order_price:this.add[i].order_price,is_fee:this.add[i].is_fee?1:0};this.add[i].id&&(d.id=this.add[i].id),t.push(d)}var a={data:t,status:1};this.activityId&&(a.id=this.activityId),this.fetch("/home/delivery/delivery/add",a).then(function(t){1==t.data.code&&t.data.data&&e.$Message.success("保存成功！")})},delRebate:function(){var e=this;this.fetch("/home/delivery/delivery/del?id="+this.activityId).then(function(t){1==t.data.code&&t.data.code&&(e.add=[],e.activityId="")})}}}},573:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Breadcrumb",{staticStyle:{background:"#f8f8f8",padding:"10px 28px"}},[i("Breadcrumb-item",{attrs:{href:"/home/addons/index"}},[e._v("插件管理")]),e._v(" "),i("Breadcrumb-item",[e._v("满减")])],1),e._v(" "),i("div",{staticStyle:{padding:"20px 28px","font-size":"18px","border-bottom":"1px solid #eee"}},[e._v("满减")]),e._v(" "),i("Row",{staticStyle:{padding:"15px 25px"}},[i("Col",[i("p",{staticStyle:{"font-size":"14px","line-height":"30px"}},[e._v("您可以设置顾客订单满指定金额后，可享受相应优惠。如「订单满50元减20元；满100元减40元，并免配送费」。")]),e._v(" "),i("p",{staticStyle:{"font-size":"14px","line-height":"30px"}},[e._v("满减活动当前仅支持在线外卖点餐时有效。")]),e._v(" "),i("Button",{directives:[{name:"show",rawName:"v-show",value:!(e.add.length>0),expression:"add.length>0?false:true"}],staticStyle:{margin:"20px 0"},attrs:{type:"primary"},on:{click:e.setRebate}},[e._v("设置满减活动")]),e._v(" "),i("Form",{directives:[{name:"show",rawName:"v-show",value:e.add.length>0,expression:"add.length>0?true:false"}],staticStyle:{"margin-top":"30px"},attrs:{"label-width":80}},[i("Form-item",{attrs:{label:"活动设置:"}},[i("Row",[i("Col",{attrs:{span:"5"}},[e._v("订单金额(元)")]),e._v(" "),i("Col",{attrs:{span:"5"}},[e._v("减免金额")]),e._v(" "),i("Col",{attrs:{span:"5"}},[e._v("配送费")])],1),e._v(" "),e._l(e.add,function(t,d){return i("Row",{key:"item",staticStyle:{"margin-bottom":"10px"}},[i("Col",{attrs:{span:"5"}},[i("Input",{staticStyle:{width:"150px"},attrs:{placeholder:""},model:{value:t.order_price,callback:function(e){t.order_price=e},expression:"item.order_price"}})],1),e._v(" "),i("Col",{attrs:{span:"5"}},[i("Input",{staticStyle:{width:"150px"},attrs:{placeholder:""},model:{value:t.discount_price,callback:function(e){t.discount_price=e},expression:"item.discount_price"}})],1),e._v(" "),i("Col",{attrs:{span:"14"}},[i("Checkbox",{on:{"on-change":function(i){e.isFee(t,d)}},model:{value:t.is_fee,callback:function(e){t.is_fee=e},expression:"item.is_fee"}},[e._v("免配送费")]),e._v(" "),i("Button",{directives:[{name:"show",rawName:"v-show",value:1!=e.add.length,expression:"add.length!=1"}],attrs:{size:"small"},on:{click:function(i){e.del(d,t.id)}}},[e._v("删除")])],1)],1)}),e._v(" "),i("Button",{attrs:{disabled:e.add.length>=3},on:{click:e.addset}},[e._v("增加一级优惠")])],2),e._v(" "),i("Form-item",{attrs:{label:""}},[i("Button",{attrs:{type:"primary"},on:{click:e.saveRebate}},[e._v("保存设置")]),e._v(" "),i("Button",{attrs:{type:"error",disabled:!e.activityId},on:{click:e.delRebate}},[e._v("删除活动")])],1)],1)],1)],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},63:function(e,t,i){var d=i(6)(i(259),i(573),null,null);d.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/pages/home/addons/rebate.vue",d.esModule&&Object.keys(d.esModule).some(function(e){return"default"!==e&&"__esModule"!==e}),d.options.functional,e.exports=d.exports}});