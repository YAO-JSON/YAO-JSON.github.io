webpackJsonp([9],{260:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(7),n=(i.n(a),new a.AMapManager);e.default={data:function(){var t=this;return{start_price:"0",delivery:"0",prompt:"立即送达",readonly:!0,add:[],times:[],divide:"0",meter:"2.000",markers:[[113.62069,34.758536]],mapCenter:[113.62069,34.758536],plugin:["ToolBar",{pName:"Scale",defaultType:0,events:{init:function(t){}}}],amapManager:n,circles:[{center:[113.62069,34.758536],radius:2e3,fillOpacity:.3,editable:!0,events:{adjust:function(e){t.meter=e.radius/1e3}}}],polygons:[{path:[[113.60069,34.738536],[113.64069,34.738536],[113.64069,34.778536],[113.60069,34.778536]],editable:!0,events:{adjust:function(e){var i=[];for(var a in e.target.G.path)i.push(e.target.G.path[a].lng+","+e.target.G.path[a].lat);t.polygon=i.join("-")}},fillOpacity:.3}],polygon:"",config:{}}},created:function(){this.$bus.emit("updateMainMenuTitle","插件管理"),this.$bus.emit("updateMainMenuActive","3-0"),this.getConfig()},methods:{getConfig:function(){var t=this;this.fetch("/home/waimai_config/index").then(function(e){if(e&&e.data.data){if(t.config=e.data.data,""==e.data.data.delivery_time)t.add=[];else{t.add=[];for(var i=e.data.data.delivery_time.split(","),a=1;a<i.length;a++)t.add.push({startTime:i[a].split("-")[0],endTime:i[a].split("-")[1]})}if(0==e.data.data.map_type?t.divide=0:t.divide=1,t.delivery=e.data.data.delivery,t.start_price=e.data.data.start_price,t.mapCenter=e.data.data.coordinate.split(","),t.markers=[],t.markers.push(e.data.data.coordinate.split(",")),t.meter=e.data.data.radius,t.circles[0].radius=1e3*e.data.data.radius,t.circles[0].center=e.data.data.coordinate.split(","),t.config.polygon){for(var n=t.config.polygon.split("-"),r=[],o=[],l=0;l<n.length;l++)r.push([n[l]]);for(var d=0;d<r.length;d++)o.push(r[d].join().split(","));t.polygons[0].path=o,t.polygon=t.config.polygon}}})},range:function(){this.circles[0].radius=1e3*this.meter},addTime:function(){this.add.push({startTime:"",endTime:""})},delTime:function(t){this.add.splice(t,1)},save:function(){var t=this;this.times=[],this.fetch("/home/config/index").then(function(e){if(!e)return void t.$Notice.open({title:"请先设置店铺信息"});for(var i in t.add){if(!t.add[i].startTime||!t.add[i].endTime)return void t.$Notice.open({title:"请设置外卖时段"});t.times.push(new Date(t.add[i].startTime).toLocaleString().split(" ")[1]+"-"+new Date(t.add[i].endTime).toLocaleString().split(" ")[1])}return t.times.unshift("立即送达"),t.start_price<0?void t.$Notice.open({title:"请设置起送价"}):t.delivery<0?void t.$Notice.open({title:"请设置配送费"}):void t.fetch("/home/waimai_config/index",{id:t.config.id,map_type:t.divide,coordinate:t.mapCenter.join(),radius:t.meter,polygon:t.polygon,delivery_time:t.times.join(),start_price:t.start_price,delivery:t.delivery}).then(function(e){if(e&&e.data.data){for(var i in t.add)t.add[i].startTime="",t.add[i].endTime="";t.start_price="",t.delivery="",t.meter="",t.getConfig(),t.$Notice.open({title:"保存成功"})}})})}}}},551:function(t,e){},567:function(t,e,i){t.exports=i.p+"a8ff7d1296a35926e1bc9d9f0f8d0082.png"},597:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Breadcrumb",{staticStyle:{background:"#f8f8f8",padding:"10px 28px"}},[a("Breadcrumb-item",{attrs:{href:"/home/addons/index"}},[t._v("插件管理")]),t._v(" "),a("Breadcrumb-item",[t._v("外卖")])],1),t._v(" "),a("div",{staticStyle:{padding:"20px 28px","font-size":"18px","border-bottom":"1px solid #eee"}},[t._v("外卖设置")]),t._v(" "),a("Row",{staticStyle:{padding:"15px 25px"}},[a("Col",[a("Form",{staticStyle:{"margin-top":"30px"},attrs:{"label-width":80}},[a("Form-item",{attrs:{label:"外卖时段："}},[a("Input",{staticStyle:{width:"180px"},attrs:{readonly:"readonly"},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}}),a("br"),t._v(" "),t._l(t.add,function(e,i){return a("div",{staticStyle:{"margin-top":"-10px"}},[a("Time-picker",{staticStyle:{width:"180px",display:"inline-block"},attrs:{format:"HH:mm",placeholder:"选择时间"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"item.startTime"}}),t._v(" "),a("div",{staticStyle:{display:"inline-block",margin:"15px 10px 0 10px"}},[t._v("至")]),t._v(" "),a("Time-picker",{staticStyle:{width:"180px",display:"inline-block"},attrs:{format:"HH:mm",placeholder:"选择时间"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"item.endTime"}}),t._v(" "),a("Button",{attrs:{type:"text"},on:{click:function(e){t.delTime(i)}}},[t._v("删除")])],1)}),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:3!=t.add.length,expression:"add.length!=3"}],staticStyle:{"margin-top":"15px"},on:{click:t.addTime}},[t._v("添加时间段")])],2),t._v(" "),a("Form-item",{attrs:{label:"配送区域："}},[a("Row",{staticStyle:{border:"1px solid #eee"}},[a("Col",{staticStyle:{height:"500px","border-right":"1px solid #eee",padding:"15px 0"},attrs:{span:"5"}},[a("Form",{attrs:{"label-width":80}},[a("Form-item",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"起送价"}},[a("div",{staticStyle:{position:"relative",display:"inline-block"}},[a("Input",{staticStyle:{width:"80px"},model:{value:t.start_price,callback:function(e){t.start_price=e},expression:"start_price"}}),t._v(" "),a("span",{staticStyle:{position:"absolute",right:"10px",top:"0",color:"#999"}},[t._v("元")])],1)]),t._v(" "),a("Form-item",{attrs:{label:"配送费"}},[a("div",{staticStyle:{position:"relative",display:"inline-block"}},[a("Input",{staticStyle:{width:"80px"},model:{value:t.delivery,callback:function(e){t.delivery=e},expression:"delivery"}}),t._v(" "),a("span",{staticStyle:{position:"absolute",right:"10px",top:"0",color:"#999"}},[t._v("元")])],1)])],1)],1),t._v(" "),a("Col",{attrs:{span:"19"}},[a("Row",{staticStyle:{"border-bottom":"1px solid #eee",padding:"10px 15px"}},[a("Col",{attrs:{span:"12"}},[a("span",[t._v("划分方式：")]),t._v(" "),a("Radio-group",{model:{value:t.divide,callback:function(e){t.divide=e},expression:"divide"}},[a("Radio",{attrs:{label:"0"}},[t._v("半径")]),t._v(" "),a("Radio",{attrs:{label:"1"}},[t._v("自定义")])],1)],1),t._v(" "),0==t.divide?a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"12"}},[a("span",[t._v("配送范围:")]),t._v(" "),a("Input",{staticStyle:{width:"80px"},on:{input:t.range},model:{value:t.meter,callback:function(e){t.meter=e},expression:"meter"}}),t._v(" "),a("span",[t._v("公里内")])],1):a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"12"}},[a("span",[t._v("配送范围:")]),t._v(" "),a("img",{staticStyle:{width:"20px",height:"20","vertical-align":"middle"},attrs:{src:i(567)}}),t._v(" "),a("span",[t._v("区域内")])])],1),t._v(" "),a("Row",[a("div",{staticClass:"amap-wrapper"},[a("el-amap",{attrs:{vid:"amap-vue",center:t.mapCenter,zoom:12,"map-manager":t.amapManager,plugin:t.plugin}},[t._l(t.markers,function(t){return a("el-amap-marker",{key:"marker",attrs:{position:t}})}),t._v(" "),t._l(t.circles,function(e){return 0==t.divide?a("el-amap-circle",{key:"circle",attrs:{center:e.center,radius:e.radius,fillOpacity:e.fillOpacity,events:e.events,editable:e.editable}}):t._l(t.polygons,function(t){return a("el-amap-polygon",{key:"polygon",attrs:{path:t.path,events:t.events,editable:e.editable,fillOpacity:t.fillOpacity}})})})],2)],1)])],1)],1)],1),t._v(" "),a("Form-item",{attrs:{label:""}},[a("Button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},64:function(t,e,i){i(551);var a=i(6)(i(260),i(597),"data-v-a688436e",null);a.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/pages/home/addons/waimai.vue",a.esModule&&Object.keys(a.esModule).some(function(t){return"default"!==t&&"__esModule"!==t}),a.options.functional,t.exports=a.exports}});