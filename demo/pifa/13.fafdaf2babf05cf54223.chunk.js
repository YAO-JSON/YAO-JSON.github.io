webpackJsonp([13],{273:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e(4),s=e.n(r);a.default={data:function(){return{toolbar:{start:"",end:"",value:"",name:"",dateBtnActive:!1},currentDataUrl:"",self:this,rightMenu:{currentActiveMenu:"",openMenu:[]},tableData:{currentDataStatus:"",ids:[],orderData:[],pagination:{}},currentOrderStatus:"",searchConditions:null,orderList:[{type:"selection",width:60,fixed:"left"},{title:"订单编号",width:150,key:"orderid"},{title:"价格(元)",width:100,key:"totalprice",render:function(t){return"<span style='color:#ff0000;'>{{row.totalprice}}</span>"}},{title:"优惠券金额",width:100,key:"coupon",render:function(t){return t.coupon?"{{row.coupon}}元":"0元"}},{title:"满减金额",width:100,key:"discount",render:function(t){return"{{row.discount}}元"}},{title:"运费",width:80,key:"freight",render:function(t){return"{{row.freight}}元"}},{title:"支付方式",width:100,key:"payment_id",render:function(t){var a=t.payment_id;return 0==a?"余额支付":1==a?"微信支付":2==a?"支付宝支付":3==a?"货到付款":void 0}},{title:"支付状态",width:100,key:"pay_status",render:function(t){return 0==t.pay_status?"<span style='color:#ff0000;'>未支付</span>":1==t.pay_status?"<span style='color:rgb(62, 208, 28);'>已支付</span>":void 0}},{title:"订单状态",width:100,key:"status",render:function(t){return 0==t.status?'<i-button type="primary" size="small">待发货</i-button>':1==t.status?'<i-button type="warning" size="small">已发货</i-button>':2==t.status?'<i-button type="success" size="small">已完成</i-button>':-1==t.status?'<i-button type="error" size="small">已关闭</i-button>':3==t.status?'<i-button type="success" size="small">已评价</i-button>':4==t.status?'<i-button type="success" size="small">退款完成</i-button>':5==t.status?'<i-button type="error" size="small">售后完成</i-button>':-2==t.status?'<i-button type="warning" size="small">退款中</i-button>':-3==t.status?'<i-button type="warning" size="small">售后中</i-button>':void 0}},{title:"订单详情",width:140,key:"detail",render:function(t,a){if(t.detail)return'<div style=\'padding:10px 0;text-align:left;\'><span v-for="item in row.detail" :key="item.name">{{item.name}}({{item.price}}元*{{item.num}})<br></span></div>'}},{title:"下单时间",width:180,key:"created_at",render:function(t){return"{{format(row.created_at)}}"}},{title:"操作",key:"action",width:70,fixed:"right",render:function(t,a,e){return'<i-button size="small" @click="detail(row)">详情</i-button>'}}],orderStatus:[{status:"allOrder",text:"全部订单"},{status:"audit",text:"待审核"},{status:0,text:"待发货"},{status:1,text:"已发货"},{status:2,text:"已完成"},{status:4,text:"退款完成"},{status:5,text:"售后完成"},{status:"-1",text:"已关闭"},{status:"-2",text:"退款中"},{status:"-3",text:"售后中"}],payStatus:[{pay_status:0,text:"待付款"},{pay_status:1,text:"已付款"}]}},created:function(){this.$bus.emit("updateMainMenuTitle","订单管理"),this.$bus.emit("updateMainMenuActive","3-0"),this.getOrder()},methods:{getOrder:function(t){var a=this;if(!t){this.rightMenu.currentActiveMenu="allOrder,order",this.rightMenu.openMenu=["orderStatus"],this.currentDataUrl="/home/order/index";var e=this.currentDataUrl;this.fetch(e).then(function(t){1==t.data.code&&t.data.data&&(a.tableData.orderData=t.data.data.data,a.tableData.pagination=t.data.data.pagination,a.tableData.ids=[],a.currentOrderStatus="")})}},reset:function(){this.toolbar.value="",this.toolbar.name="",this.toolbar.start="",this.toolbar.end="",this.getOrder()},search:function(){if(this.toolbar.value||this.toolbar.name||this.toolbar.start&&this.toolbar.end){var t=[];this.toolbar.value&&t.push("keyword="+this.toolbar.value),this.toolbar.name&&t.push("name="+this.toolbar.name),this.toolbar.start&&(t.push("start_time="+this.format(this.toolbar.start)),t.push("end_time="+this.format(this.toolbar.end)));var a="/home/order/search_order?"+t.join("&");this.currentDataUrl="/home/order/search_order",this.getOrderData(a)}else this.$Message.error("请输入完整收搜信息！")},day:function(t){this.toolbar.start=new Date((new Date).getTime()-24*t*3600*1e3),this.toolbar.end=new Date,this.toolbar.dateBtnActive=!0},searchOrderByStatus:function(t){var a=t.split(","),e=a[0],r=a[1],s="";return"allOrder"==e?void this.getOrder():"audit"==e?void this.$router.push("/home/order/audit"):("order"==r&&(s="status="+e),"pay"==r&&(s="pay_status="+e),this.currentOrderStatus=s,void this.searchOrderData())},searchOrderData:function(){var t=[];this.currentOrderStatus&&t.push(this.currentOrderStatus),this.tableData.pagination.page&&t.push("page="+this.tableData.pagination.page),(this.toolbar.value||this.toolbar.name||this.toolbar.start&&this.toolbar.end)&&(this.toolbar.value&&t.push("keyword="+this.toolbar.value),this.toolbar.name&&t.push("name="+this.toolbar.name),this.toolbar.start&&(t.push("start_time="+this.format(this.toolbar.start)),t.push("end_time="+this.format(this.toolbar.end))));var a="/home/order/status_order?"+t.join("&");this.currentDataUrl="/home/order/status_order",this.getOrderData(a)},getOrderData:function(t){var a=this;this.fetch(t).then(function(t){1==t.data.code&&t.data.data?(a.tableData.orderData=t.data.data.data,a.tableData.pagination=t.data.data.pagination):(a.tableData.orderData=[],a.tableData.pagination={})})},selectionRow:function(t){this.tableData.ids=[];for(var a=0;a<t.length;a++)this.tableData.ids.push(t[a].id)},detail:function(t){this.$router.push({path:"/home/order/detail",query:{id:t.id,text:"订单详情",status:t.status}})},exportOrder:function(){if(this.tableData.orderData.length){var t=["Authorization="+s.a.defaults.headers.common.Authorization,"WxaToken="+s.a.defaults.headers.common.WxaToken];this.tableData.ids.join("")&&t.push("ids="+this.tableData.ids.join(",")),this.tableData.currentDataStatus&&t.push("status="+this.tableData.currentDataStatus),window.open(s.a.defaults.baseURL+"/home/order/export?"+t.join("&"))}else this.$Message.error("还没有订单")},changePage:function(t){var a=this.currentDataUrl||"/home/order/index";if(this.toolbar.value||this.toolbar.name||this.toolbar.start&&this.toolbar.end){var e=[];this.toolbar.value&&e.push("keyword="+this.toolbar.value),this.toolbar.name&&e.push("name="+this.toolbar.name),this.toolbar.start&&(e.push("start_time="+this.format(this.toolbar.start)),e.push("end_time="+this.format(this.toolbar.end)))}this.currentOrderStatus&&submitData.push(this.currentOrderStatus),this.tableData.pagination.page&&submitData.push("page="+this.tableData.pagination.page),a+=submitData.join("&"),this.getOrderData(a)}}}},554:function(t,a){},602:function(t,a,e){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Row",{staticStyle:{background:"#f8f8f8",padding:"10px 20px","margin-bottom":"10px"}},[e("Col",{staticClass:"select",attrs:{span:"4"}},[e("Input",{attrs:{placeholder:"订单号"},model:{value:t.toolbar.value,callback:function(a){t.toolbar.value=a},expression:"toolbar.value"}})],1),t._v(" "),e("Col",{staticClass:"select",attrs:{span:"4"}},[e("Input",{attrs:{placeholder:"收货人姓名"},model:{value:t.toolbar.name,callback:function(a){t.toolbar.name=a},expression:"toolbar.name"}})],1),t._v(" "),e("Col",{staticClass:"select",attrs:{span:"4"}},[e("Date-picker",{attrs:{type:"datetime",placeholder:"选择开始日期和时间",format:"yyyy-MM-dd HH:mm:ss"},model:{value:t.toolbar.start,callback:function(a){t.toolbar.start=a},expression:"toolbar.start"}})],1),t._v(" "),e("Col",{attrs:{span:"1"}},[e("div",{staticClass:"select",staticStyle:{height:"32px","line-height":"32px","text-align":"center"}},[t._v("至")])]),t._v(" "),e("Col",{staticClass:"select",attrs:{span:"4"}},[e("Date-picker",{attrs:{type:"datetime",placeholder:"选择结束日期和时间",format:"yyyy-MM-dd HH:mm:ss"},model:{value:t.toolbar.end,callback:function(a){t.toolbar.end=a},expression:"toolbar.end"}})],1),t._v(" "),e("Col",{staticClass:"select",attrs:{span:"4"}},[e("Button",{staticStyle:{"margin-right":"10px"},on:{click:function(a){t.day("7")}}},[t._v("近7天")]),t._v(" "),e("Button",{on:{click:function(a){t.day("30")}}},[t._v("近30天")])],1),t._v(" "),e("Col",{attrs:{span:"24"}},[e("Button",{on:{click:t.reset}},[t._v("重置")]),t._v(" "),e("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")])],1)],1),t._v(" "),e("Row",[e("Col",{attrs:{span:"4"}},[e("Menu",{attrs:{width:"auto","active-name":t.rightMenu.currentActiveMenu,"open-names":t.rightMenu.openMenu},on:{"on-select":t.searchOrderByStatus}},[e("Submenu",{attrs:{name:"orderStatus"}},[e("template",{slot:"title"},[e("Icon",{attrs:{type:"ios-paper"}}),t._v("\n                         订单状态\n                    ")],1),t._v(" "),t._l(t.orderStatus,function(a){return e("Menu-item",{key:a.status,attrs:{name:a.status+",order"}},[t._v(t._s(a.text))])})],2),t._v(" "),e("Submenu",{attrs:{name:"payStatus"}},[e("template",{slot:"title"},[e("Icon",{attrs:{type:"ios-paper"}}),t._v("\n                         支付状态\n                    ")],1),t._v(" "),t._l(t.payStatus,function(a){return e("Menu-item",{key:a.pay_status,attrs:{name:a.pay_status+",pay"}},[t._v(t._s(a.text))])})],2)],1)],1),t._v(" "),e("Col",{attrs:{span:"20"}},[e("Table",{attrs:{context:t.self,height:"800",data:t.tableData.orderData,columns:t.orderList,stripe:""},on:{"on-selection-change":t.selectionRow}}),t._v(" "),e("div",{staticStyle:{margin:"15px 0",overflow:"hidden"}},[e("Button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:t.exportOrder}},[t._v("导出订单")]),t._v(" "),e("div",{staticStyle:{float:"right"}},[e("Page",{attrs:{total:t.tableData.pagination.rowCount,current:t.tableData.pagination.page,"page-size":t.tableData.pagination.pageSize},on:{"on-change":t.changePage}})],1)],1)],1)],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},76:function(t,a,e){e(554);var r=e(6)(e(273),e(602),"data-v-e22d1030",null);r.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/pages/home/order/index.vue",r.esModule&&Object.keys(r.esModule).some(function(t){return"default"!==t&&"__esModule"!==t}),r.options.functional,t.exports=r.exports}});