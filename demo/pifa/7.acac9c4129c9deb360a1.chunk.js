webpackJsonp([7],{112:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(4);i.n(o),e.default={data:function(){return{selected:{id:0},file:[],pagination:{page:1,pageCount:0,pageSize:0,rowCount:0},showModal:!1}},props:{show:{default:!1},fileUrl:{default:"/home/file/index"}},watch:{show:function(t,e){this.showModal=t,this.selected={id:0},this.showModal&&this.search()}},created:function(){},methods:{selectImage:function(t){if(t.id==this.selected.id)return void(this.selected={id:0});this.selected=t},cancelImage:function(){this.$emit("on-cancel",!0)},selectedImage:function(){this.$emit("on-selected",this.selected)},changePage:function(t){this.pagination.page=t,this.search()},search:function(){var t=this;this.fetch(this.fileUrl+"?page="+this.pagination.page).then(function(e){e&&e.data.data&&(t.file=e.data.data.data,t.pagination=e.data.data.pagination)})},handleAddSuccess:function(t,e){this.search()}}}},116:function(t,e){},118:function(t,e,i){i(116);var o=i(6)(i(112),i(119),null,null);o.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/components/uploader.vue",o.esModule&&Object.keys(o.esModule).some(function(t){return"default"!==t&&"__esModule"!==t}),o.options.functional,t.exports=o.exports},119:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{title:"图片上传管理器",closable:!0,"mask-closable":!1},on:{"on-ok":t.selectedImage,"on-cancel":t.cancelImage},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[i("Row",[i("Col",{attrs:{span:"6"}},[i("Upload",{attrs:{action:t.getUrl("/home/file/add"),"on-success":t.handleAddSuccess,format:["jpg","jpeg","png"],multiple:"",type:"drag","max-size":2048,"show-upload-list":!1,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,headers:t.uploadHeaders()}},[i("div",{staticStyle:{padding:"20px 0"}},[i("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),i("p",[t._v("点击或将文件拖拽到这里上传")])],1)])],1)],1),t._v(" "),i("hr",{staticStyle:{"margin-top":"20px","border-top":"1px solid #e3e8ee","border-bottom":"0"}}),t._v(" "),i("Row",{staticStyle:{"margin-top":"20px"}},t._l(t.file,function(e,o){return i("Col",{key:o,staticStyle:{"text-align":"center",float:"left"},attrs:{span:4}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.getFile(e),expression:"getFile(item)"}],staticStyle:{width:"120px",height:"120px",border:"1px solid #e3e8ee",padding:"3px","border-radius":"3px"},on:{click:function(i){t.selectImage(e)}}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.selected.id==e.id,expression:"selected.id == item.id"}],staticStyle:{"line-height":"128px",position:"absolute",bottom:"0",left:"0",right:"0",background:"rgba(0,0,0,.6)",cursor:"pointer","font-size":"16px"},on:{click:function(i){t.selectImage(e)}}},[i("Icon",{attrs:{type:"checkmark-circled",size:"20",color:"#fff"}}),t._v(" "),i("span",{staticStyle:{color:"#fff"}},[t._v("已选择")])],1)])})),t._v(" "),i("Row",[[i("Page",{staticStyle:{float:"right",margin:"10px"},attrs:{total:t.pagination.rowCount,current:t.pagination.page,"show-elevator":"","page-size":t.pagination.pageSize},on:{"on-change":t.changePage}})]],2)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},254:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(4),a=i.n(o),s=i(118),n=i.n(s);e.default={components:{Uploader:n.a},data:function(){return{showUploadBox:!1,fileUrl:"",imgId:"",imgUrl:"",pageName:"4545",options:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}},formItem:{name:"",num:"0",price:"0",get_num:"0",start_time:"",last_time:"",use_price:"0"},isAdd:!0,selectId:"",disabled:!1,maxlength:10}},created:function(){var t=this;this.$bus.emit("updateMainMenuTitle","插件管理"),this.$bus.emit("updateMainMenuActive","5-0"),this.selectId=this.$route.query.id,this.pageName=this.$route.query.pageName,this.selectId&&(this.isAdd=!1,this.fetch("/home/coupon/index/add?id="+this.selectId).then(function(e){e&&e.data.code&&(t.formItem=e.data.data,t.formItem.get_num=e.data.data.get_num+"",e.data.data.file.id?(t.imgUrl=t.getFile(e.data.data.file),t.imgId=e.data.data.file_id):(t.imgUrl="",t.imgId=""),t.formItem.get_num==t.formItem.num&&(t.formItem.get_num="0"))}))},methods:{uploadImg:function(){this.modal=!1,this.showUploadBox=!0,this.fileUrl=a.a.defaults.baseURL+"/home/file/index"},handleSuccess:function(t){this.modal=!0,this.showUploadBox=!1,t.id>0?(this.imgUrl=this.getFile(t),this.imgId=t.id):this.$Notice.open({title:"请选择图片"})},cancelUpload:function(){this.showUploadBox=!1},handleDel:function(){this.imgUrl="",this.imgId=""},ok:function(){var t=this;return this.formItem.name?this.formItem.num<=0?void this.$Notice.open({title:"发放总量必须大于0张"}):this.formItem.price<=0?void this.$Notice.open({title:"优惠券面值必须大于0元"}):this.formItem.use_price-0<=this.formItem.price-0?void this.$Notice.open({title:"订单金额应大于优惠券面值"}):this.formItem.start_time?this.formItem.last_time?this.formItem.get_num-0>this.formItem.num-0?void this.$Notice.open({title:"领取数量应小于总量"}):(0==this.formItem.get_num&&(this.formItem.get_num=this.formItem.num),void(this.isAdd?this.fetch("/home/coupon/index/add",{name:this.formItem.name,price:this.formItem.price,num:this.formItem.num,start_time:this.formItem.start_time,last_time:this.formItem.last_time,use_price:this.formItem.use_price,get_num:this.formItem.get_num}).then(function(e){e&&e.data.code&&(t.$Notice.open({title:"新增成功"}),t.$router.push("/home/addons/coupon"))}):this.fetch("/home/coupon/index/add",{name:this.formItem.name,price:this.formItem.price,num:this.formItem.num,start_time:this.formItem.start_time,last_time:this.formItem.last_time,use_price:this.formItem.use_price,get_num:this.formItem.get_num,id:this.selectId}).then(function(e){e&&e.data.code&&(t.$Notice.open({title:"修改成功"}),t.$router.push("/home/addons/coupon"))}))):void this.$Notice.open({title:"请选择结束时间"}):void this.$Notice.open({title:"请选择开始时间"}):void this.$Notice.open({title:"请填写优惠券名称"})}}}},57:function(t,e,i){var o=i(6)(i(254),i(580),null,null);o.options.__file="/Users/yaojiasong/YJSON/boke/vue/pingful-pifa-www/src/pages/home/addons/edit.vue",o.esModule&&Object.keys(o.esModule).some(function(t){return"default"!==t&&"__esModule"!==t}),o.options.functional,t.exports=o.exports},580:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Breadcrumb",{staticStyle:{background:"#f8f8f8",padding:"10px 28px"}},[i("Breadcrumb-item",{attrs:{href:"/home/addons/index"}},[t._v("插件管理")]),t._v(" "),i("Breadcrumb-item",{attrs:{href:"/home/addons/coupon"}},[t._v("优惠券")]),t._v(" "),i("Breadcrumb-item",[t._v("新增优惠券")])],1),t._v(" "),i("div",{staticStyle:{padding:"20px 28px","font-size":"18px","border-bottom":"1px solid #eee","margin-bottom":"15px"}},[t._v("优惠券")]),t._v(" "),i("Form",{staticStyle:{"margin-left":"30px"},attrs:{model:t.formItem,"label-width":100}},[i("Form-item",{attrs:{label:"优惠券名称："}},[i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"最多10个字",maxlength:t.maxlength},model:{value:t.formItem.name,callback:function(e){t.formItem.name=e},expression:"formItem.name"}})],1),t._v(" "),i("Form-item",{attrs:{label:"发送数量："}},[i("div",{staticStyle:{position:"relative",display:"inline-block"}},[i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:t.formItem.num,callback:function(e){t.formItem.num=e},expression:"formItem.num"}}),t._v(" "),i("span",{staticStyle:{position:"absolute",right:"10px",top:"0",color:"#999"}},[t._v("张")])],1)]),t._v(" "),i("Form-item",{attrs:{label:"面值："}},[i("div",{staticStyle:{position:"relative",display:"inline-block"}},[i("Input",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:t.formItem.price,callback:function(e){t.formItem.price=e},expression:"formItem.price"}}),t._v(" "),i("span",{staticStyle:{position:"absolute",right:"10px",top:"0",color:"#999"}},[t._v("元")])],1)]),t._v(" "),i("Form-item",{attrs:{label:"每人限领："}},[i("Select",{staticStyle:{width:"200px"},model:{value:t.formItem.get_num,callback:function(e){t.formItem.get_num=e},expression:"formItem.get_num"}},[i("Option",{attrs:{value:"0"}},[t._v("不限张")]),t._v(" "),i("Option",{attrs:{value:"1"}},[t._v("1张")]),t._v(" "),i("Option",{attrs:{value:"2"}},[t._v("2张")]),t._v(" "),i("Option",{attrs:{value:"3"}},[t._v("3张")]),t._v(" "),i("Option",{attrs:{value:"4"}},[t._v("4张")]),t._v(" "),i("Option",{attrs:{value:"5"}},[t._v("5张")]),t._v(" "),i("Option",{attrs:{value:"10"}},[t._v("10张")])],1)],1),t._v(" "),i("Form-item",{attrs:{label:"使用限制："}},[i("span",[t._v("订单满")]),t._v(" "),i("Input",{staticStyle:{width:"100px",margin:"0 10px"},attrs:{placeholder:""},model:{value:t.formItem.use_price,callback:function(e){t.formItem.use_price=e},expression:"formItem.use_price"}}),t._v(" "),i("span",[t._v("可用")])],1),t._v(" "),i("Form-item",{attrs:{label:"可用时间："}},[i("Date-picker",{staticStyle:{width:"200px",display:"inline-block","margin-right":"10px"},attrs:{type:"datetime",placeholder:"选择开始时间",format:"yyyy-MM-dd HH-mm-ss",options:t.options},model:{value:t.formItem.start_time,callback:function(e){t.formItem.start_time=e},expression:"formItem.start_time"}}),t._v(" "),i("Date-picker",{staticStyle:{width:"200px",display:"inline-block"},attrs:{type:"datetime",placeholder:"选择结束时间",format:"yyyy-MM-dd HH-mm-ss",options:t.options},model:{value:t.formItem.last_time,callback:function(e){t.formItem.last_time=e},expression:"formItem.last_time"}}),t._v(" "),i("div",[t._v("优惠券创建后即可被领取，这里设置的「开始时间」是指优惠券可被使用的时间")])],1),t._v(" "),i("Form-item",{attrs:{label:""}},[i("Button",{attrs:{type:"primary"},on:{click:t.ok}},[t._v("完成")])],1)],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0}});