{"version":3,"sources":["../../../../src/components/goods/goods.js"],"names":["data","goods","listHeight","scrollY","selectedFood","props","seller","type","Object","created","classMap","$nextTick","_initScroll","_caclulateHeight","computed","currentIndex","i","length","height1","height2","selectFoods","foods","map","good","food","count","push","components","Carcontrol","Shopcar","Food","methods","menuScroll","$refs","click","foodScroll","probeType","on","pos","Math","abs","round","y","foodList","getElementsByClassName","height","item","clientHeight","selectMenu","index","el","scrollToElement","cartAdd","target","shopcar","_drop","selectFood","e","stopPropagation","show"],"mappings":"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","file":"goods.js","sourcesContent":["// const ERR_OK = 0;\nimport { goods } from '../../../data.json';\nimport BScroll from 'better-scroll';\nimport Carcontrol from 'components/carcontrol/carcontrol.vue';\nimport Shopcar from 'components/shopcar/shopcar.vue';\nimport Food from 'components/food/food.vue';\nexport default {\n  data() {\n    return {\n      goods: [],\n      listHeight: [],\n      scrollY: 0,\n      selectedFood: {}\n    };\n  },\n  props: {\n    seller: {\n      type: Object\n    }\n  },\n  created() {\n    this.classMap = ['decrease', 'discount', 'special', 'invoice', 'guarantee'];\n    // this.$http.get('/api/goods').then((res) => {\n    //   res = res.body;\n    //   if (res.errno === ERR_OK) {\n    //     this.goods = res.data;\n    //     this.$nextTick(() => {\n    //       this._initScroll();\n    //       this._caclulateHeight();\n    //     });\n    //   };\n    // });\n    this.goods = goods;\n    this.$nextTick(() => {\n      this._initScroll();\n      this._caclulateHeight();\n    });\n  },\n  computed: {\n    currentIndex() {\n      for (let i = 0; i < this.listHeight.length; i++) {\n          let height1 = this.listHeight[i];\n          let height2 = this.listHeight[i + 1];\n          if (!height2 || (this.scrollY >= height1 && this.scrollY < height2)) {\n            return i;\n          }\n      }\n    },\n    selectFoods() {\n      let foods = [];\n      this.goods.map((good) => {\n        good.foods.map((food) => {\n          if (food.count) {\n            foods.push(food);\n          }\n        });\n      });\n      return foods;\n    }\n  },\n  components: { Carcontrol, Shopcar, Food },\n  methods: {\n    _initScroll() {\n      this.menuScroll = new BScroll(this.$refs['menu-wrapper'], {\n        click: true\n      });\n      this.foodScroll = new BScroll(this.$refs['food-wrapper'], {\n        probeType: 3,\n        click: true\n      });\n\n      this.foodScroll.on('scroll', (pos) => {\n        this.scrollY = Math.abs(Math.round(pos.y));\n      });\n    },\n    _caclulateHeight() {\n      let foodList = this.$refs['food-wrapper'].getElementsByClassName('food-list-hook');\n      let height = 0;\n      this.listHeight.push(height);\n      for (let i = 0; i < foodList.length; i++) {\n        let item = foodList[i];\n        height += item.clientHeight;\n        this.listHeight.push(height);\n      }\n    },\n    selectMenu(index) {\n      let foodList = this.$refs['food-wrapper'].getElementsByClassName('food-list-hook');\n      let el = foodList[index];\n      this.foodScroll.scrollToElement(el, 500);\n    },\n    cartAdd(target) {\n      this.$refs.shopcar._drop(target);\n    },\n    selectFood(food, e) {\n      e.stopPropagation();\n      this.selectedFood = food;\n      this.$refs.food.show();\n    }\n  }\n};\n"]}